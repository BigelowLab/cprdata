---
title: "NFSC-CPR"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

This R package facilitates access and analysis of [NFSC](https://www.fisheries.noaa.gov/about/northeast-fisheries-science-center) [Continuous Plankton Recorder](https://en.wikipedia.org/wiki/Continuous_Plankton_Recorder) (CPR) data.  Data can imported from distrubuted [Excel](https://en.wikipedia.org/wiki/Microsoft_Excel) spreadsheets into data frames, [tibbles](https://tibble.tidyverse.org/) or [sf tables](https://r-spatial.github.io/sf/).

>Part of this dataset was obtained from [NOAA's NFSC](https://www.fisheries.noaa.gov/about/northeast-fisheries-science-center) on 20 January 2024 and might not represent the most up to date data. Please contact NOAA directly for the most recent data. The balance of this dataset is avaiable from the [NERACOOS ERDDAP server](https://www.neracoos.org/erddap/index.html).

## Requirements

+ [R v4.1+](https://www.r-project.org/)
+ [rlang](https://CRAN.R-project.org/package=rlang)
+ [dplyr](https://CRAN.R-project.org/package=dplyr)
+ [readxl](https://CRAN.R-project.org/package=readxl)
+ [stringr](https://CRAN.R-project.org/package=stringr)
+ [readr](https://CRAN.R-project.org/package=readr)

## Installation

```
remotes::install_github("BigelowLab/nfsccrp")
```

## Usage

### Read the data

The dataset contains both zooplankton and phytoplankton data from the Mid-Atlantic Bight and Gulf of Maine regions.  We regularily access to the zooplankton data, but it is easy to switch to phytoplankton.  We can read the data in its "raw" state as a simple table or transformed into a [sf]() POINT table.

####  Read as a wide table
```{r}
library(nfsccpr)
x = read_cpr(name = "zooplankton", form = "table") |>
  dplyr::glimpse()
```


#### Read as a sf POINT table
```{r}
x = read_cpr(name = "zooplankton",  form = "sf") |>
  dplyr::glimpse() 
```

#### Plot points

```{r, message=FALSE, warning=FALSE}
suppressPackageStartupMessages({
  library(sf)
  library(rnaturalearth)
})
coast = ne_coastline(scale = 110, returnclass = "sf")
plot(st_geometry(coast), extent = x, axes = TRUE)
plot(st_geometry(x), pch = ".", col = "orange", add = TRUE)
```